version: "3.8"
services:
  janus-gateway:
    build:
      context: .
      dockerfile: Dockerfile
    image: janus-gateway:custom
    command: ["/opt/janus/bin/janus", "-F", "/opt/janus/etc/janus"]
    ports:
      - "5002:5002/udp"
      - "5004:5004/udp"
      - "5100-5150:5100-5150/udp"
      - "8188:8188"
      - "7088:7088"
    volumes:
      - ./janus-config/janus.jcfg:/opt/janus/etc/janus/janus.jcfg
      - ./janus-config/janus.plugin.videoroom.jcfg:/opt/janus/etc/janus/janus.plugin.videoroom.jcfg
      - ./janus-config/janus.transport.pfunix.jcfg:/opt/janus/etc/janus/janus.transport.pfunix.jcfg
      - ./janus-config/janus.transport.websockets.jcfg:/opt/janus/etc/janus/janus.transport.websockets.jcfg
      - ./janus-config/janus.plugin.streaming.jcfg:/opt/janus/etc/janus/janus.plugin.streaming.jcfg
      - ./recordings:/opt/janus/recordings
    environment:
      - PUBLIC_IP=auto
    restart: unless-stopped

  web_server:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./html:/usr/share/nginx/html
    restart: unless-stopped